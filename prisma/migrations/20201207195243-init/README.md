# Migration `20201207195243-init`

This migration has been generated by alexismalzieu at 12/7/2020, 8:52:43 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "Instruction" DROP CONSTRAINT "Instruction_recipeId_fkey"

ALTER TABLE "IngredientsOnRecipe" ALTER COLUMN "ingredientId" DROP NOT NULL

ALTER TABLE "Instruction" ALTER COLUMN "recipeId" SET NOT NULL

ALTER TABLE "Recipe" ALTER COLUMN "instructionId" SET NOT NULL

CREATE UNIQUE INDEX "Ingredient.name_unique" ON "Ingredient"("name")
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201206110124-init..20201207195243-init
--- datamodel.dml
+++ datamodel.dml
@@ -2,9 +2,9 @@
 // learn more about it in the docs: https://pris.ly/d/prisma-schema
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
@@ -14,32 +14,32 @@
   id                  Int                   @id @default(autoincrement())
   name                String
   prepTime            Int?
   cookingTime         Int?
-  instruction         Instruction?          @relation(fields: [instructionId], references: [id])
-  instructionId       Int?
+  instruction         Instruction           @relation(fields: [instructionId], references: [id])
+  instructionId       Int
   tags                Tag[]
   sourceUrl           String?
   IngredientsOnRecipe IngredientsOnRecipe[]
 }
 model Ingredient {
   id                        Int                   @id @default(autoincrement())
-  name                      String
+  name                      String                @unique
   alternativeNames          Ingredient[]          @relation("IngredientToIngredient")
   alternativeIngredientName Ingredient?           @relation("IngredientToIngredient", fields: [alternativeingredientId], references: [id])
   alternativeingredientId   Int?
   IngredientsOnRecipe       IngredientsOnRecipe[]
 }
 model IngredientsOnRecipe {
-  id           Int        @id @default(autoincrement())
-  recipe       Recipe     @relation(fields: [recipeId], references: [id])
+  id           Int         @id @default(autoincrement())
+  recipe       Recipe      @relation(fields: [recipeId], references: [id])
   recipeId     Int
-  ingredient   Ingredient @relation(fields: [ingredientId], references: [id])
-  ingredientId Int
+  ingredient   Ingredient? @relation(fields: [ingredientId], references: [id])
+  ingredientId Int?
   base_amout   Int?
-  base_unit    Unit?      @relation(fields: [unitId], references: [id])
+  base_unit    Unit?       @relation(fields: [unitId], references: [id])
   unitId       Int?
 }
 enum System {
@@ -62,14 +62,12 @@
   recipes Recipe[]
 }
 model Instruction {
-  id          Int               @id @default(autoincrement())
-  steps       InstructionStep[]
-  recipe      Instruction?      @relation(fields: [recipeId], references: [id])
-  recipeId    Int?
-  Recipe      Recipe[]
-  Instruction Instruction[]     @relation("InstructionToInstruction")
+  id       Int               @id @default(autoincrement())
+  steps    InstructionStep[]
+  recipeId Int
+  Recipe   Recipe[]
 }
 model InstructionStep {
   id            Int         @id @default(autoincrement())
```


